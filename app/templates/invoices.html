{% extends "base.html" %}
{% block title %}Invoices - Invoicing App{% endblock %}

{% block content %}
<div class="flex justify-between items-center mb-4">
  <h1 class="text-2xl font-semibold">Invoices</h1>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
  <!-- LIST + STATUS EDIT + DELETE -->
  <div class="lg:col-span-2 bg-white shadow rounded p-4">
    <h2 class="text-lg font-semibold mb-2">Invoice List</h2>
    <table class="w-full text-sm">
      <thead>
        <tr class="border-b">
          <th class="text-left py-2">ID</th>
          <th class="text-left py-2">Customer</th>
          <th class="text-left py-2">Status</th>
          <th class="text-right py-2">Total</th>
          <th class="text-center py-2">PDF</th>
          <th class="text-center py-2">Actions</th>
        </tr>
      </thead>
      <tbody id="invoicesTableBody"></tbody>
    </table>
  </div>

  <!-- CREATE INVOICE FORM -->
  <div class="bg-white shadow rounded p-4 text-sm">
    <h2 class="text-lg font-semibold mb-2">Create Invoice</h2>
    <form id="invoiceForm" class="space-y-3">
      <div>
        <label class="block mb-1">Customer</label>
        <select id="invoiceCustomer" class="w-full border px-2 py-1 rounded" required></select>
      </div>

      <div>
        <label class="block mb-1">Status</label>
        <select id="invoiceStatus" class="w-full border px-2 py-1 rounded">
          <option value="draft">Draft</option>
          <option value="sent">Sent</option>
          <option value="paid">Paid</option>
        </select>
      </div>

      <div>
        <label class="block mb-1">Items</label>
        <div id="invoiceItemsContainer" class="space-y-2"></div>
        <button type="button" id="addLineBtn"
          class="mt-2 text-xs px-2 py-1 border rounded text-blue-600 border-blue-300 hover:bg-blue-50">
          + Add Item
        </button>
      </div>

      <p id="invoiceError" class="text-xs text-red-600 hidden"></p>
      <button class="w-full bg-blue-600 text-white rounded py-1.5 hover:bg-blue-700">
        Create Invoice
      </button>
    </form>
  </div>
</div>

<!-- EDIT INVOICE ITEMS PANEL -->
<div class="mt-6 bg-white shadow rounded p-4 text-sm" id="editInvoicePanel" style="display:none">
  <div class="flex justify-between items-center mb-3">
    <h2 id="editInvoiceTitle" class="text-lg font-semibold">
      Edit Invoice Items
    </h2>
    <button id="cancelEditInvoiceBtn"
            class="text-xs px-2 py-1 border rounded text-gray-700 hover:bg-gray-100">
      Close
    </button>
  </div>

  <form id="editInvoiceForm" class="space-y-3">
    <div>
      <label class="block mb-1">Invoice ID</label>
      <p id="editInvoiceIdLabel" class="text-sm font-semibold"></p>
    </div>

    <div>
      <label class="block mb-1">Items</label>
      <div id="editInvoiceItemsContainer" class="space-y-2"></div>
      <button type="button" id="editAddLineBtn"
        class="mt-2 text-xs px-2 py-1 border rounded text-blue-600 border-blue-300 hover:bg-blue-50">
        + Add Item
      </button>
    </div>

    <p id="editInvoiceError" class="text-xs text-red-600 hidden"></p>
    <button class="bg-green-600 text-white rounded py-1.5 px-3 hover:bg-green-700">
      Save Changes
    </button>
  </form>
</div>
{% endblock %}
